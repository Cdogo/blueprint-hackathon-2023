import Head from 'next/head'
import { Inter } from '@next/font/google'
import styles from '@/styles/Home.module.css'

import Feed from '@/components/feed.js'

import { useState } from 'react';

import Image from 'next/image';

const inter = Inter({ subsets: ['latin'] })
import { useAuthState } from 'react-firebase-hooks/auth';

import { auth, firestore } from "@/components/firebase"

export default function Home() {
  let [user] = useAuthState(auth)

  const CreatePost = () => {
    const [website, setWebsite] = useState('')

    const CreatePost = async (e) => {
      e.preventDefault()
      const commentRef = firestore.collection(`websites`);
      var currentdate = new Date();
      if (!/^(http(s):\/\/.)[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)$/.test(website)){ alert('Input a valid URL'); return;}
      await commentRef.add({
          link:website,
          user:user.email,
        
      })
      setWebsite('')
    }
    return (
      <form onSubmit={CreatePost} className = 'max-w-screen-md w-full flex flex-col gap-3 mb-3'>
        <label for = 'website'className = 'font-bold'>Create a post</label>
        <input type = 'text' value = {website} onChange={(e) => {setWebsite(e.target.value)}} name = 'website' placeholder = 'Input Website Here' className = 'border outline-none w-full p-3 border-gray-300 rounded-lg'/>
        <input className = 'bg-[#FF5733] w-full p-3 font-bold text-white rounded-lg pointer' type = 'submit' value = 'Create Post'/>
      </form>
    );
  }
  return (
    <>
      <Head>
        <title>ReWeb</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        {user && <CreatePost/>}
        <Feed/>
      </main>
      <Image className = 'fixed bottom-3 left-3' src = '/Red_Bull.png' width={100} height={50}/>
    </>
  )
}
